const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SearchResults-D1wsHYnF.js","assets/index-D0o61ohh.js","assets/index-C55LVeGN.css","assets/Tracklist-CAZehYjo.js","assets/DuplicateTrackModal-B__Jn3wk.js"])))=>i.map(i=>d[i]);
import{r as t,j as s,_ as N}from"./index-D0o61ohh.js";import{T as B}from"./Tracklist-CAZehYjo.js";import V from"./SearchBar-BWjnwZ9F.js";import"./api-CSMmyyCN.js";const F=t.lazy(()=>N(()=>import("./SearchResults-D1wsHYnF.js"),__vite__mapDeps([0,1,2,3]))),H=t.lazy(()=>N(()=>import("./DuplicateTrackModal-B__Jn3wk.js"),__vite__mapDeps([4,1,2])));function X({existingPlaylist:R,selectedPlaylist:l,setTracksEdited:i,trackEdited:p,onEdit:P,handleExitEditMode:v,onNameChange:_,setSearchLoading:K,tracksEdited:u}){const a=R[l],[L,S]=t.useState(!1),[w,g]=t.useState(null),[,m]=t.useState(!1),[x,k]=t.useState(a?a.playlistName:""),[D,E]=t.useState([]),A=10,[,q]=t.useState({}),d=t.useRef(null),h=t.useRef(null),y=t.useRef(null),f=t.useCallback(()=>{y.current&&(y.current.offsetWidth<932?d.current&&h.current&&(d.current.offsetHeight>200?h.current.classList.add("large-height"):h.current.classList.remove("large-height")):h.current.classList.remove("large-height"))},[]);t.useEffect(()=>{f(),window.addEventListener("resize",f);const e=new MutationObserver(f);return d.current&&e.observe(d.current,{childList:!0,subtree:!0}),()=>{window.removeEventListener("resize",f),e.disconnect()}},[f]),t.useEffect(()=>{a?(k(a.playlistName),i(a.tracks)):console.log("Selected Playlist Obj is undefined"),a.tracks.forEach(e=>{e.id})},[a,i]);const I=()=>{l&&(P(l,u),_(x,l),v())},O=e=>{$(e),m(!1),g(null)},T=()=>{m(!1),g(null)},b=()=>{S(!1)},W=t.useCallback(e=>{E(e||[])},[]),$=t.useCallback(e=>{const n=e.id;q(r=>{const c={...r};c[n]=(c[n]||1)+1;const o=`${n}-${c[n]}`,z={...e,uniqueKey:o};return setTimeout(()=>{i(j=>j.some(M=>M.uniqueKey===o)?j:[z,...j])},0),c})},[i]),C=t.useCallback(e=>{const n=e.id;if(u.some(o=>o.id===n)){g(e),m(!0);return}const c={...e,uniqueKey:`${n}-1`};i(o=>[c,...o])},[u,i,m]);return s.jsxs("div",{className:"displayEditingPlaylist",ref:y,children:[s.jsx("div",{className:"spacer"}),s.jsx("div",{className:"editingSection",ref:h,children:l!==null&&s.jsxs("div",{className:"EditingPlaylist",id:`EditingPlaylist-${a.playlistId}`,children:[s.jsxs("div",{className:"editingMainContainer",children:[L?s.jsx("input",{type:"text",value:x,onChange:e=>k(e.target.value),onBlur:b,onKeyDown:e=>e.key==="Enter"&&b(),autoFocus:!0}):s.jsx("h3",{onClick:()=>S(!0),children:`Editing: ${x}`}),s.jsxs("div",{className:"editingButtons",children:[s.jsx("button",{onClick:I,children:"Save"}),s.jsx("button",{onClick:v,children:"Cancel"})]})]}),s.jsx(B,{keyPrefix:"editing",tracks:u,onAdd:C,onRemove:e=>i(n=>n.filter(r=>r.uniqueKey!==e.uniqueKey)),tracksEdited:u,tracksPerPage:10,allowDuplicateAdd:!1},l+1),s.jsx(t.Suspense,{fallback:s.jsx("div",{children:"Loading..."}),children:s.jsx(H,{track:w,onConfirm:O,onCancel:T})})]})}),s.jsx("div",{className:"editingSearch",ref:d,children:s.jsxs("div",{className:"searchForNewTracks",children:[s.jsx("h3",{children:"Search"}),s.jsx(V,{onSearchResults:W,setSearchLoading:K}),s.jsx(t.Suspense,{fallback:s.jsx("div",{children:"Loading..."}),children:s.jsx(F,{tracks:D,keyPrefix:"editing-",onAdd:C,onRemove:e=>i(n=>n.filter(r=>r.uniqueKey!==e.uniqueKey)),tracksEdited:p,selectedPlaylist:l,playlistTracks:p,allowDuplicateAdd:!1,tracksPerPage:A})})]})})]})}export{X as default};
