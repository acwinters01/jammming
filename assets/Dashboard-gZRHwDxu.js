const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PagesSetUp-BGaj_aPZ.js","assets/index-R5YN88vi.js","assets/index-BXyZoNpc.css"])))=>i.map(i=>d[i]);
import{r as a,m as _,j as s,g as U,a as $,_ as N}from"./index-R5YN88vi.js";const I=a.lazy(()=>N(()=>import("./PagesSetUp-BGaj_aPZ.js"),__vite__mapDeps([0,1,2]))),L=a.lazy(()=>N(()=>import("./index-R5YN88vi.js").then(u=>u.L),__vite__mapDeps([1,2]))),M=({setExistingPlaylist:u})=>{var b;const[d,E]=a.useState(null),[c,S]=a.useState(null),[x,f]=a.useState(null),[k,T]=a.useState(!0),[A,j]=a.useState(!1),[h,v]=a.useState(0),m=5;a.useEffect(()=>{(async()=>{try{const t=await U();E(t);try{const r=await $(t.id);S(r)}catch(r){f("An error occurred while fetching the user playlists."),console.error("Error fetching playlists:",r)}}catch(t){f("An error occurred while fetching the user profile."),console.error("Error fetching profile:",t)}finally{T(!1)}})()},[]);const C=()=>{if(!c||!c.items)return;const e=c.items.length,t=Math.ceil(e/m);h<t-1&&v(r=>r+1)},w=()=>{h>0&&v(e=>e-1)},D=a.useCallback(async e=>{let t=[];j(!0);try{const l=await _(`playlists/${e.id}/tracks`,"GET");let n=l.items||[];if(l.total>100){const i=Math.ceil(l.total/100);n=[...l.items];for(let o=1;o<i;o++){let p=o*100,y=new URLSearchParams({offset:p,limit:100}),P=await _(`playlists/${e.id}/tracks?${y.toString()}`,"GET");n=[...n,...P.items]}}!Array.isArray(n)||n.length;let g={};n.forEach(i=>{var p;const o=i.track.id;if(i&&i.track){g[o]?g[o]++:g[o]=1;const y=g[o];let P={id:i.track.id,uniqueKey:`${o}-${y}`,name:i.track.name,artist:i.track.artists.map(R=>R.name).join(", "),album:i.track.album.name,uri:i.track.uri,image:((p=i.track.album.images[1])==null?void 0:p.url)||"./public/music_note_baseImage.jpg"};t.push(P)}})}catch(l){console.error("Error fetching playlist tracks:",l)}let r={playlistName:e.name,playlistId:e.id,tracks:t};u(l=>{const n=Array.isArray(l)?l:[];return r.tracks&&r.tracks.length>0?[...n,r]:n}),j(!1)},[u]);return s.jsx("div",{className:"displayDashboard",children:k?s.jsxs("div",{className:"dashboardLoading",children:[s.jsx("p",{children:"Loading..."}),s.jsx(a.Suspense,{children:s.jsx(L,{isLoading:!0})})]}):s.jsxs(s.Fragment,{children:[x&&s.jsxs("p",{children:["Error: ",x]}),d?s.jsxs("div",{className:"userInfoContainer",children:[s.jsxs("div",{className:"userInfo",children:[s.jsx("div",{className:"dashboardProfileImage",children:s.jsx("img",{src:(b=d.images[0])==null?void 0:b.url,alt:"Profile"})}),s.jsxs("div",{className:"dashboardText",children:[s.jsx("h2",{children:d.display_name}),s.jsxs("p",{children:["Email: ",d.email]}),s.jsxs("p",{children:["Country: ",d.country]})]})]}),s.jsx("div",{className:"usersPlaylist-TitleContainer",children:s.jsxs("h3",{children:["Playlists Listed Under ",d.display_name,":"]})}),c&&c.items&&c.items.length>0?s.jsxs("div",{className:"usersPlaylistsContainer",children:[c.items.slice(h*m,(h+1)*m).map((e,t)=>{var r;return s.jsxs("div",{className:"dashboardPlaylist",children:[s.jsx("div",{className:"dashboardPlaylistImages",children:e.images&&e.images.length>0?s.jsx("img",{src:((r=e.images[0])==null?void 0:r.url)||"",alt:"Playlist"}):s.jsx("div",{children:"No Image"})}),A?s.jsx(a.Suspense,{children:s.jsx(L,{isLoading:!0})}):s.jsxs("div",{className:"playlistText",id:"dashboardText",children:[s.jsx("p",{children:e.name}),s.jsx("button",{id:"toApp",onClick:()=>D(e),children:"Sync Playlist to App"},`${t}-toApp`)]})]},t)}),s.jsx(a.Suspense,{children:s.jsx(I,{currentPage:h,totalPages:Math.ceil(c.items.length/m),goToNextPage:C,goToPreviousPage:w})})]}):s.jsx("p",{children:"No playlists available"})]}):s.jsx("div",{className:"userProfileLoading",children:s.jsx("p",{children:"Loading profile..."})})]})})};export{M as default};
