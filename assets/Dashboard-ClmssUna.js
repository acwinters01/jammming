const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PagesSetUp-Or9votAh.js","assets/index-CKNA3gvs.js","assets/index-C55LVeGN.css","assets/Loading-k-1oU6F-.js"])))=>i.map(i=>d[i]);
import{r as a,j as s,_ as k}from"./index-CKNA3gvs.js";import{m as L,g as U,a as $}from"./api-KtTI157l.js";const I=a.lazy(()=>k(()=>import("./PagesSetUp-Or9votAh.js"),__vite__mapDeps([0,1,2]))),_=a.lazy(()=>k(()=>import("./Loading-k-1oU6F-.js"),__vite__mapDeps([3,1,2]))),z=({setExistingPlaylist:y})=>{var b;const[d,N]=a.useState(null),[o,E]=a.useState(null),[f,j]=a.useState(null),[S,T]=a.useState(!0),[A,P]=a.useState(!1),[h,v]=a.useState(0),m=5;a.useEffect(()=>{(async()=>{try{const t=await U();N(t);try{const i=await $(t.id);E(i)}catch(i){j("An error occurred while fetching the user playlists."),console.error("Error fetching playlists:",i)}}catch(t){j("An error occurred while fetching the user profile."),console.error("Error fetching profile:",t)}finally{T(!1)}})()},[]);const C=()=>{if(!o||!o.items)return;const e=o.items.length,t=Math.ceil(e/m);h<t-1&&v(i=>i+1)},w=()=>{h>0&&v(e=>e-1)},D=a.useCallback(async e=>{let t=[];P(!0);try{const l=await L(`playlists/${e.id}/tracks`,"GET");let n=l.items||[];if(l.total>100){const r=Math.ceil(l.total/100);n=[...l.items];for(let c=1;c<r;c++){let g=c*100,p=new URLSearchParams({offset:g,limit:100}),x=await L(`playlists/${e.id}/tracks?${p.toString()}`,"GET");n=[...n,...x.items]}}!Array.isArray(n)||n.length;let u={};n.forEach(r=>{var g;const c=r.track.id;if(r&&r.track){u[c]?u[c]++:u[c]=1;const p=u[c];let x={id:r.track.id,uniqueKey:`${c}-${p}`,name:r.track.name,artist:r.track.artists.map(R=>R.name).join(", "),album:r.track.album.name,uri:r.track.uri,image:((g=r.track.album.images[1])==null?void 0:g.url)||"./public/music_note_baseImage.jpg"};t.push(x)}})}catch(l){console.error("Error fetching playlist tracks:",l)}let i={playlistName:e.name,playlistId:e.id,tracks:t};y(l=>{const n=Array.isArray(l)?l:[];return i.tracks&&i.tracks.length>0?[...n,i]:n}),P(!1)},[y]);return s.jsx("div",{className:"displayDashboard",children:S?s.jsxs("div",{className:"dashboardLoading",children:[s.jsx("p",{children:"Loading..."}),s.jsx(a.Suspense,{fallback:s.jsx("div",{children:"Loading..."}),children:s.jsx(_,{isLoading:!0})})]}):s.jsxs(s.Fragment,{children:[f&&s.jsxs("p",{children:["Error: ",f]}),d?s.jsxs("div",{className:"userInfoContainer",children:[s.jsxs("div",{className:"userInfo",children:[s.jsx("div",{className:"dashboardProfileImage",children:s.jsx("img",{src:(b=d.images[0])==null?void 0:b.url,alt:"Profile"})}),s.jsxs("div",{className:"dashboardText",children:[s.jsx("h2",{children:d.display_name}),s.jsxs("p",{children:["Email: ",d.email]}),s.jsxs("p",{children:["Country: ",d.country]})]})]}),s.jsx("div",{className:"usersPlaylist-TitleContainer",children:s.jsxs("h3",{children:["Playlists Listed Under ",d.display_name,":"]})}),o&&o.items&&o.items.length>0?s.jsxs("div",{className:"usersPlaylistsContainer",children:[o.items.slice(h*m,(h+1)*m).map((e,t)=>{var i;return s.jsxs("div",{className:"dashboardPlaylist",children:[s.jsx("div",{className:"dashboardPlaylistImages",children:e.images&&e.images.length>0?s.jsx("img",{src:((i=e.images[0])==null?void 0:i.url)||"",alt:"Playlist"}):s.jsx("div",{children:"No Image"})}),A?s.jsx(a.Suspense,{fallback:s.jsx("div",{children:"Loading..."}),children:s.jsx(_,{isLoading:!0})}):s.jsxs("div",{className:"playlistText",id:"dashboardText",children:[s.jsx("p",{children:e.name}),s.jsx("button",{id:"toApp",onClick:()=>D(e),children:"Sync Playlist to App"},`${t}-toApp`)]})]},t)}),s.jsx(a.Suspense,{fallback:s.jsx("div",{children:"Loading..."}),children:s.jsx(I,{currentPage:h,totalPages:Math.ceil(o.items.length/m),goToNextPage:C,goToPreviousPage:w})})]}):s.jsx("p",{children:"No playlists available"})]}):s.jsx("div",{className:"userProfileLoading",children:s.jsx("p",{children:"Loading profile..."})})]})})};export{z as default};
