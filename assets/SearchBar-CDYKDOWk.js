import{r,j as t}from"./index-CKNA3gvs.js";import{g as y,m as E}from"./api-KtTI157l.js";const I=({onSearchResults:u,setSearchLoading:a})=>{const[c,m]=r.useState(""),[n,l]=r.useState([]),[S,h]=r.useState(!1),o=r.useRef(null);r.useEffect(()=>{const e=JSON.parse(localStorage.getItem("recentSearches"))||[];l(e)},[l]);const p=e=>{const s=e.target.value;m(s)},x=e=>{m(e),d(e),h(!1)},v=()=>{h(!0)};r.useEffect(()=>{const e=s=>{o.current&&!o.current.contains(s.target)&&h(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[o]);const d=r.useCallback(async(e=c,s=0,g=1)=>{a(!0);const j=await y();let R=new URLSearchParams({q:e,type:"track",limit:50,market:j.country,offset:s*g});try{const i=await E(`search?${R.toString()}`,"GET");u(i.tracks.items),a(!1);const f=[e,...n.filter(k=>k!==e)].slice(0,5);l(f),localStorage.setItem("recentSearches",JSON.stringify(f))}catch(i){console.error("Error fetching search results:",i),a(!1)}},[c,u,n,a]),w=e=>{e.preventDefault(),d(c)};return t.jsx("div",{className:"displaySearchBar",children:t.jsxs("div",{className:"searchWithRecentContainer",children:[t.jsxs("form",{className:"searchForm",onSubmit:w,children:[t.jsx("input",{type:"text",placeholder:"Search tracks",onChange:p,onFocus:v,value:c}),t.jsx("button",{type:"submit",id:"searchButton",children:"Search"})]}),t.jsx("div",{className:`recentSearchesContainer ${S?"show":""}`,ref:o,children:n.length>0&&t.jsx("div",{className:"recentSearches",children:n.map((e,s)=>t.jsx("div",{className:"singleSearch",children:t.jsx("p",{onClick:()=>x(e),children:e},s)},`search-${s}`))})})]})})};export{I as default};
