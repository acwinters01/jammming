const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/EditPlaylist-v0Tk9VXC.js","assets/index-CvB8lNfj.js","assets/index-5WWwfwsc.css","assets/Tracklist-CLuwbdBs.js","assets/SearchBar-Di6tYzhx.js","assets/api-C581K6af.js","assets/PagesSetUp-BScq0hE7.js"])))=>i.map(i=>d[i]);
import{R as F,r,j as s,_ as x}from"./index-CvB8lNfj.js";import{T as J}from"./Tracklist-CLuwbdBs.js";import{m as g}from"./api-C581K6af.js";const K=r.lazy(()=>x(()=>import("./EditPlaylist-v0Tk9VXC.js"),__vite__mapDeps([0,1,2,3,4,5]))),G=r.lazy(()=>x(()=>import("./PagesSetUp-BScq0hE7.js"),__vite__mapDeps([6,1,2])));function H({existingPlaylist:e,setExistingPlaylist:h,onNameChange:d,onEdit:T,onAdd:N,onRemove:S,onSave:E,playlistTracks:I,playlistName:_,searchResults:R,setSearchLoading:b,setTransferLoading:P,onEditOpen:w,onEditClose:C,dashboardOpen:A,setShowModal:$}){var k;const[p,y]=r.useState(null),[o,u]=r.useState(0),[O,m]=r.useState([]),i=5,n=o*i,j=Array.isArray(e)&&e.length<i?e:e.slice(n,n+i),L=r.useCallback(a=>{d(a.target.value,null)},[d]),D=a=>{A?$(!0):(y(a),m(e[a].tracks),w())},U=()=>{y(null),m([]),C()},z=async a=>{let t=[];return e[a].tracks.forEach(l=>{l.uri?t.push(l.uri):console.warn(`Track URI missing for ${l.name}`)}),t},B=a=>{try{h(t=>t.filter(l=>l.playlistId!==a))}catch(t){console.log(t)}},M=()=>{(o+1)*i<e.length&&u(a=>a+1)},V=()=>{o>0&&u(a=>a-1)},q=async a=>{P(!0);try{const t=await z(a),l={name:e[a].playlistName,description:"New playlist created from Jammming app",public:!0},f=(await g("me/playlists","POST",l)).id;h(c=>{const v=[...c];return v[a].playlistId=f,v});try{const c={uris:t};await g(`playlists/${f}/tracks`,"POST",c)}catch(c){console.error("Error adding tracks to the playlist:",c)}}catch(t){console.error("Error transferring playlist to Spotify:",t)}finally{P(!1)}};return s.jsxs("div",{className:"displayPlaylistsContainer",children:[s.jsxs("div",{className:"playlistNameInput",children:[s.jsx("input",{"data-testid":"playlist-name-input",onChange:L,value:_,placeholder:"New Playlist"}),s.jsx("button",{id:"saveButton",onClick:E,children:"Save"})]}),s.jsx(J,{keyPrefix:"playlist",tracks:I,onAdd:N,onRemove:S,allowDuplicateAdd:!1,tracksPerPage:5}),s.jsxs("div",{className:"allPlaylists",children:[j.length>0?j.map((a,t)=>{const l=a.playlistId;return s.jsx("div",{className:"Playlist",id:`playlist-${l}`,children:s.jsxs("div",{className:"playlistSectionOne",children:[s.jsxs("div",{className:"playlistImage",children:[s.jsx("img",{src:a.tracks[0].imageUri||a.tracks[0].image||"/music_note_baseImage.jpg",alt:"Track artwork"}),s.jsx("button",{id:"transferToSpotify","data-testid":`${a.playlistId}-Transfer`,onClick:()=>q(t+n),children:"Save On Spotify"})]}),s.jsxs("div",{className:"playlistText",children:[s.jsxs("div",{className:"playlistTitleInfo",children:[s.jsx("h4",{children:a.playlistName}),s.jsxs("p",{children:["Tracks: ",a.tracks.length]})]}),s.jsxs("div",{className:"playlistButtons",children:[s.jsx("button",{"data-testid":`${a.playlistId}-Remove`,onClick:()=>B(a.playlistId),children:"Remove"}),s.jsx("button",{"data-testid":`${a.playlistId}-EditPlaylist`,onClick:()=>D(t+n),children:"Edit"})]})]})]})},l)}):s.jsx("div",{className:"playlistsNotFound",children:s.jsx("p",{children:"No playlists available"})}),s.jsx(r.Suspense,{fallback:s.jsx("div",{children:"Loading..."}),children:s.jsx("div",{className:"pagination",children:s.jsx(G,{currentPage:o,setCurrentPage:u,totalPages:Math.ceil(e.length/i),goToNextPage:M,goToPreviousPage:V})})}),s.jsx(r.Suspense,{fallback:s.jsx("div",{children:"Loading..."}),children:p!==null&&s.jsx("div",{className:"editPlaylistContainer",children:s.jsx(K,{selectedPlaylist:p,setSelectedPlaylist:y,tracks:(k=e[p])==null?void 0:k.tracks,searchResults:R,onNameChange:d,existingPlaylist:e,tracksEdited:O,setTracksEdited:m,onEdit:T,handleExitEditMode:U,setSearchLoading:b})})})]})]})}const Z=F.memo(H);export{Z as default};
